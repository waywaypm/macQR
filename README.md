# macQR - 智能二维码识别工具

macQR 是一款基于 macOS 平台的智能二维码识别工具，通过状态栏图标提供快捷的二维码扫描功能，支持多屏幕扫描和多个二维码识别。

## 功能特性

- 📱 **状态栏应用**：无需打开主窗口，通过状态栏图标即可快速访问所有功能
- 🖥️ **多屏幕扫描**：支持扫描所有连接的屏幕
- 🔍 **多二维码识别**：同时识别屏幕上的多个二维码
- ⚡ **快速操作**：一键扫描、复制和查看历史记录
- 📋 **自动复制**：识别结果自动复制到剪贴板
- 🔔 **通知提醒**：识别结果通过通知提醒用户
- 📁 **历史记录**：保存识别历史，方便随时查看
- 🎨 **现代化UI**：符合 Apple 设计规范的用户界面
- 📦 **一键打包**：提供便捷的构建和打包脚本

## 安装方法

### 方法一：使用 DMG 安装包（推荐）

1. 从 [GitHub Release](https://github.com/waywaypm/macQR/releases) 页面下载最新版本的 `macQR.dmg` 文件
2. 打开 DMG 文件
3. 将 `macQR.app` 拖放到 `Applications` 文件夹
4. 从 Launchpad 或 Applications 文件夹中打开应用

### 方法二：从源代码构建

1. 克隆或下载项目代码
2. 确保已安装 Xcode 或 Swift Toolchain
3. 在项目根目录执行以下命令：
   ```bash
   ./build-and-run-app.sh
   ```
4. 构建完成后，在 `Applications` 文件夹中找到 `macQR.app`

## 使用方法

### 基本使用

1. **扫描二维码**：
   - 点击状态栏的二维码图标
   - 选择 "识别屏幕二维码" 选项
   - 应用会自动扫描所有屏幕上的二维码
   - 识别结果会自动复制到剪贴板，并通过通知提醒

2. **查看历史记录**：
   - 点击状态栏的二维码图标
   - 选择 "查看历史记录" 选项
   - 在弹出的窗口中查看所有识别历史

3. **复制最新结果**：
   - 点击状态栏的二维码图标
   - 选择 "复制最新" 选项（显示最近一次识别结果）
   - 结果会自动复制到剪贴板

### 主窗口功能

- **开始识别**：点击 "开始识别" 按钮，手动触发二维码扫描
- **权限管理**：查看和管理应用权限（屏幕录制、通知）
- **清晰的结果展示**：支持同时显示多个二维码识别结果

## 权限说明

macQR 需要以下权限才能正常工作：

1. **屏幕录制权限**：用于扫描屏幕上的二维码
2. **通知权限**：用于发送识别结果通知

### 如何授予权限

- **屏幕录制权限**：
  - 首次运行应用时，系统会自动请求权限
  - 或前往 "系统设置" > "隐私与安全性" > "屏幕录制"，勾选 macQR

- **通知权限**：
  - 首次运行应用时，系统会自动请求权限
  - 或前往 "系统设置" > "通知"，找到 macQR 并开启通知

## 配置说明

### 应用设置

macQR 的配置主要通过系统设置进行管理：

- **通知设置**：在 "系统设置" > "通知" 中调整通知样式和行为
- **屏幕录制设置**：在 "系统设置" > "隐私与安全性" > "屏幕录制" 中管理权限

### 日志设置

macQR 默认在开发模式下输出日志，生产模式下只记录必要的日志到文件。日志文件位于应用的运行目录。

## 常见问题解答

### Q: 应用无法扫描二维码

A: 请检查以下几点：
1. 确保已授予屏幕录制权限
2. 确保屏幕上有清晰可见的二维码
3. 尝试调整屏幕亮度或二维码大小
4. 重启应用后再试

### Q: 应用不显示通知

A: 请检查以下几点：
1. 确保已授予通知权限
2. 前往 "系统设置" > "通知"，确保 macQR 的通知已开启
3. 检查通知中心的 "请勿打扰" 模式是否开启

### Q: 应用不显示在状态栏

A: 请检查以下几点：
1. 确保应用正在运行
2. 前往 "系统设置" > "控制中心" > "菜单栏项目"，确保 "状态栏图标" 设置正确
3. 尝试重启应用

### Q: 如何更新应用

A: 目前 macQR 不支持自动更新，请定期访问 GitHub Release 页面下载最新版本的 DMG 文件进行手动更新。

### Q: 打开应用时提示"macQR.app 已损坏，无法打开"或"来自身份不明开发者"

A: 这是因为应用未经过 Apple Developer ID 签名，macOS 的 Gatekeeper 安全机制默认阻止未签名应用运行。您可以通过以下方法解决：

#### 方法一：单次打开（推荐用于首次尝试）
1. 在 Finder 中找到 `macQR.app`（通常在 Applications 文件夹中）
2. 按住 `Control` 键，同时点击应用图标
3. 在弹出的菜单中选择 "打开"
4. 在出现的警告窗口中，点击 "打开" 按钮

#### 方法二：永久允许所有来源应用
注意：此方法会降低系统安全性，请谨慎使用！
1. 打开 "终端" 应用（位于 Applications > Utilities 文件夹中）
2. 执行以下命令：
   ```bash
   sudo spctl --master-disable
   ```
3. 输入您的 macOS 登录密码（密码不会显示在终端中）
4. 按回车键执行命令
5. 前往 "系统设置" > "隐私与安全性"，您会看到 "允许从以下位置下载的 App" 选项已变为 "任何来源"
6. 现在可以正常打开 macQR 应用了

#### 方法三：移除隔离属性
1. 打开 "终端" 应用
2. 执行以下命令，将 `/Applications/macQR.app` 替换为实际的应用路径：
   ```bash
   xattr -rd com.apple.quarantine /Applications/macQR.app
   ```
3. 按回车键执行命令
4. 现在可以正常打开 macQR 应用了

### Q: 没有 Apple Developer ID 可以开发让别人使用的软件吗？

A: 是的，您可以在没有 Apple Developer ID 的情况下开发和分发 macOS 软件，只是需要用户按照上述方法手动允许应用运行。

#### 无 Apple Developer ID 开发注意事项：
1. 应用无法通过 Mac App Store 分发
2. 无法使用某些高级系统功能（如 Push Notifications、iCloud 等）
3. 用户需要手动绕过 Gatekeeper 安全机制才能运行应用
4. 无法获得 Apple 的技术支持和测试工具
5. 应用图标上不会显示 Apple 认证的 "已验证开发者" 标识

#### 开发流程建议：
1. 按照正常流程开发和构建应用
2. 打包成 DMG 文件便于用户安装
3. 在 README 中详细说明未签名应用的打开方法
4. 建议用户使用 "Control + 点击" 或 "移除隔离属性" 的方法打开应用
5. 考虑加入自动更新机制，方便用户获取最新版本

## 贡献指南

欢迎对 macQR 进行贡献！无论是 bug 报告、功能建议还是代码贡献，我们都非常欢迎。

### 如何贡献

1. Fork 本仓库
2. 创建特性分支（`git checkout -b feature/AmazingFeature`）
3. 提交更改（`git commit -m 'Add some AmazingFeature'`）
4. 推送到分支（`git push origin feature/AmazingFeature`）
5. 开启 Pull Request

### 开发环境设置

- Xcode 15.0+ 或 Swift 5.9+
- macOS 13.0+ 开发环境

### 代码规范

- 遵循 Swift 官方代码规范
- 保持代码简洁清晰
- 添加必要的注释
- 确保所有代码通过编译和 lint 检查

### 测试

在提交代码前，请确保：
1. 代码可以正常编译
2. 功能测试通过
3. 没有明显的性能问题

## 技术栈

- **开发语言**：Swift 5.9+
- **UI 框架**：SwiftUI
- **二维码识别**：Vision 框架
- **构建工具**：Swift Package Manager
- **开发环境**：macOS 13.0+

## 许可证

macQR 采用 MIT 许可证，详见 [LICENSE](LICENSE) 文件。

## 联系方式

- **GitHub**：[https://github.com/yourusername/macQR](https://github.com/yourusername/macQR)
- **Issue 报告**：[https://github.com/yourusername/macQR/issues](https://github.com/yourusername/macQR/issues)

## 版本历史

### v1.0 (2025-12-02)

**新特性**：
- ✅ 状态栏应用，无需主窗口即可使用
- ✅ 支持多屏幕二维码扫描
- ✅ 支持同时识别多个二维码
- ✅ 自动复制识别结果到剪贴板
- ✅ 支持查看识别历史记录
- ✅ 现代化的 SwiftUI 界面
- ✅ 符合 Apple 设计规范的用户体验
- ✅ 自动请求必要权限
- ✅ 支持通知提醒

**改进**：
- 优化了二维码识别算法
- 改进了用户界面设计
- 增强了错误处理
- 简化了构建和打包流程

**已知问题**：
- 暂无

## 致谢

感谢所有为 macQR 做出贡献的开发者和用户！

---

**macQR** - 让二维码识别更加简单高效！
